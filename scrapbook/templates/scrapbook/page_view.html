{% extends 'scrapbook/base.html' %}
{% load static %}


    {% block page_title %} 
        <h2>{{ page.title }} <br>({{ scrapbook.owner.first_name }}'s Scrapbook)</h2>
    {% endblock %}

    {% block extra_button %} 
        <a href="{% url 'scrapbook:scrapbook_view' username=page.scrapbook.owner.username %}"><button id="back" class="btn btn-primary"><strong>BACK</strong></button></a> 
    {% endblock %}
{% block body_block %} 

<link href="{% static 'scrapbook/css/page_view.css' %}" rel="stylesheet">
<!-- header section with title, nav buttons and dementia clock-->
<div class="container-fluid">
    <div class="row justify-content-center">
        <h4>Page Created By: {{page.creator.first_name}}</h4>
    </div>
    <!-- row for video, notes and image-->
    <div id="main_row" class="row px-4">
        <div class="col-sm-4">
            {% if page.video_file %}
            <video id="uploaded_vid" source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/mp4"controls width="100%">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/mp4">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/webm">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/ogv">
                <p>Sorry, your internet browser is having trouble with playing videos on the page.</p> 
            </video>
            {% elif page.vid_src %}
                <iframe id="youtube" width="100%" height="70%" src="" 
                frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            {% else %} 
                <button class="btn btn-success">No video yet. Add now.</button>
            {% endif %}
        </div>
        <div class="col-sm-4 justify-content-center">
            <div class="container">
                <div id="note_card" class="card">
                    <div  class="card-body">
                        <h6 class="card-text text-center">Add a Note</h6>
                        <h6 class="card-subtitle">Title</h6>
                        <div class="form-group">
                            <input id="title_input" class="form-control txtarea"></input>
                        </div>
                        <h6 class="card-subtitle">Note</h6>
                        <div class="form-group">
                            {% csrf_token %}
                            <textarea class="form-control txtarea" id="add_note" rows="3"></textarea>
                        </div>
                        
                        <button class="btn btn-sm btn-success" id="add">
                        Add Note</button>
                    </div>
                </div>
                <hr>
                <div class="text-center">
                <a href="{% url 'scrapbook:view_notes' page_pk=page.id %}"><button id="notes_button" class="btn btn-sm btn-success border border-dark">
                    <h5>Open Notes</h5></button></a>
                </div>
            </div>
        </div>
        <div class="col-sm-4 px-0">
            {% if page.image_file %}
                <img class="img-fluid" id="picture" src="{{ MEDIA_URL }}{{page.image_file}}" alt="Your chosen image for {{page.title}}" />
            {% else %} 
                <a href="{% url 'scrapbook:image_update' page_pk=page.id %}"><button class="btn btn-success justify-content-center">No image yet<br> Add now</button></a>
            {% endif %}
            </div>
    </div>

    <!-- row for song-->
    <div id="spotify_row" class="row justify-content-center">
        <iframe id="spotify" style="border-radius:12px" src="" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
    </div>

</div>


<div id="player"></div> 




<script type="text/javascript">

    var page_pk = "{{page.id}}";
    window.onload = function()
    {
        var url = "{{ page.song_embed }}"
    
        // Set an ID for the iframe. Let us give that an id of myframe
        document.getElementById("spotify").setAttribute("src", url);
      
        var vidSrc = "{{ page.vid_src }}"
        document.getElementById("youtube").setAttribute("src", vidSrc);

    }

</script>


<script type="text/javascript" src="{% static 'scrapbook/js/page_view.js' %}"> </script>
{% endblock %}