{% extends 'scrapbook/base.html' %}
{% load static %}
{% block body_block %} 
<link href="{% static 'scrapbook/css/page_view.css' %}" rel="stylesheet">

<!-- header section with title, nav buttons and dementia clock-->
<div class="container-fluid">
    <div id="header" class="row">

        <!-- column for buttons-->
        <div class="col-sm-4">
            <div class="container">
                <div class="row">
                    <a href="{% url 'scrapbook:help' %}"><button id="help_button" class="btn btn-primary"><strong>HELP PAGE</strong></button></a> 
                </div>
                <div class="row">
                    <a href="{% url 'scrapbook:index' %}"><button id="home_button" class="btn btn-primary"><strong>HOME</strong></button></a> 
                </div>
            </div>
        </div>

        <!--column for scrapbook and title-->
        <div class="col-sm-4">
            <div class="container">
                <div class="row justify-content-center">
                    <h5>{{ scrapbook.owner.first_name }}'s Scrapbook ({{ scrapbook.owner.username}})</h5>
                </div>
                <div class="row justify-content-center">
                    
                    <h3>{{ page.title}}</h3>
                </div>
            </div>
        </div>

        <!-- column for dementia clock-->
        <div class="col-sm-4">
            <div class="container">
                <div id="clock" class="row justify-content-center">
                    <h4>{{clock|linebreaks}}</h4>
                </div>
            </div>
        </div>

    </div>

    <!-- row for video, notes and image-->
    <div id="main_row" class="row px-4">
        <div class="col-sm-4">
            {% if page.video_file %}
            <video source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/mp4"controls width="100%">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/mp4">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/webm">
                <source src="{{ MEDIA_URL }}{{page.video_file}}" type="video/ogv">
                <p>Sorry, your internet browser is having trouble with playing videos on the page.</p> 
            </video>
            {% elif page.vid_src %}
                <iframe id="youtube" width="100%" height="70%" src="" 
                frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            {% else %} 
                <button class="btn btn-success">No video yet. Add now.</button>
            {% endif %}
        </div>
        <div class="col-sm-4 justify-content-center">
            <div class="container">
                <div id="note_card" class="card">
                    <div  class="card-body">
                        <h6 class="card-text text-center">Add a Note</h6>
                        <h6 class="card-subtitle">Title</h6>
                        <div class="form-group">
                            <input id="title_input" class="form-control txtarea"></input>
                        </div>
                        <h6 class="card-subtitle">Note</h6>
                        <div class="form-group">
                            {% csrf_token %}
                            <textarea class="form-control txtarea" id="add_note" rows="3"></textarea>
                        </div>
                        
                        <button class="btn btn-sm btn-success" id="add">
                        Add Note</button>
                    </div>
                </div>
                <hr>
                <div class="text-center">
                <a href="{% url 'scrapbook:view_notes' page_pk=page.id %}"><button id="notes_button" class="btn btn-sm btn-success "><h5>Open Notes</h5></button></a>
                </div>
            </div>
        </div>
        <div class="col-sm-4 px-0">
            {% if page.image_file %}
                <img class="img-fluid" id="picture" src="{{ MEDIA_URL }}{{page.image_file}}" alt="Your chosen image for {{page.title}}" />
            {% else %} 
                <button class="btn btn-success justify-content-center">No image yet<br> Add now</button>
            {% endif %}
            </div>
    </div>

    <!-- row for song-->
    <div id="spotify_row" class="row justify-content-center">
        <iframe id="spotify" style="border-radius:12px" src="" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
    </div>

</div>


<div id="player"></div> 




<script type="text/javascript">

    var page_pk = "{{page.id}}";
    window.onload = function()
    {
        var url = "{{ page.song_embed }}"
    
        // Set an ID for the iframe. Let us give that an id of myframe
        document.getElementById("spotify").setAttribute("src", url);
      
        var vidSrc = "{{ page.vid_src }}"
        document.getElementById("youtube").setAttribute("src", vidSrc);

    }

</script>


<script type="text/javascript" src="{% static 'scrapbook/js/page_view.js' %}"> </script>
{% endblock %}